<!DOCTYPE html>
<html lang="en">


<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="SPARKER - Premium directory and listings template by Ansonika.">
    <meta name="author" content="Ansonika">
    <title>Discover Business</title>

    <!-- Favicons-->
    <link rel="shortcut icon" href="img/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon" type="image/x-icon" href="img/apple-touch-icon-57x57-precomposed.png">
    <link rel="apple-touch-icon" type="image/x-icon" sizes="72x72" href="img/apple-touch-icon-72x72-precomposed.png">
    <link rel="apple-touch-icon" type="image/x-icon" sizes="114x114" href="img/apple-touch-icon-114x114-precomposed.png">
    <link rel="apple-touch-icon" type="image/x-icon" sizes="144x144" href="img/apple-touch-icon-144x144-precomposed.png">

    <!-- GOOGLE WEB FONT -->
    

    <!-- BASE CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">
	<link href="css/vendors.css" rel="stylesheet">

	<!-- ALTERNATIVE COLORS CSS -->
	<link href="#" id="colors" rel="stylesheet">

    <!-- YOUR CUSTOM CSS -->
    <link href="css/custom.css" rel="stylesheet">
	<link href="newStyle.css" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,600,700" rel="stylesheet">

</head>

<body>
	
	<div id="page">
		
	<header class="header_in is_sticky menu_fixed">
		<div class="container">
			<div class="row">
				<div class="col-lg-3 col-12">
					<div id="logo">
						<a href="index.html">
							<img src="images/logo-sticky.png" width="165" height="35" alt="" class="logo_sticky">
						</a>
					</div>
				</div>
				<div class="col-lg-9 col-12">
					<!-- /top_menu -->
					<a href="#menu" class="btn_mobile">
						<div class="hamburger hamburger--spin" id="hamburger">
							<div class="hamburger-box">
								<div class="hamburger-inner"></div>
							</div>
						</div>
					</a>
					<nav id="menu" class="main-menu">
						<ul>
							<li><span><a href="index-5.html">Home</a></span></li>
							<li><span><a href="about.html">About Us</a></span></li>
							<li><span><a href="directory.html">Listings</a></span></li>
								<li><span><a href="events.html">Events</a></span></li>
							<li><span><a href="contacts.html">Contact Us</a></span></li>
						</ul>
					</nav>
				</div>
			</div>
			<!-- /row -->
		</div>
		<!-- /container -->		
	</header>
	<!-- /header -->
		
	<div class="sub_header_in sticky_header">
	
		<div class="container">
			<h1>Events</h1>
		</div>
		<!-- /container -->
	</div>
	<!-- /sub_header -->
	
	<main>
		<div class="container margin_60_35">
			<div class="box_booking">
				<div class="strip_booking" id="event-list-container">
				</div>
			</div>
		</div>
	</main>
	<!--/main-->
	
	<footer class="plus_border">
		<div class="container margin_60_35">
			<div class="row">
				<div class="col-lg-3 col-md-6 col-sm-6">
					<a data-toggle="collapse" data-target="#collapse_ft_1" aria-expanded="false" aria-controls="collapse_ft_1" class="collapse_bt_mobile">
						<h3>Quick Links</h3>
						<div class="circle-plus closed">
							<div class="horizontal"></div>
							<div class="vertical"></div>
						</div>
					</a>
					<div class="collapse show" id="collapse_ft_1">
						<ul class="links">
							<li><a href="about.html">About us</a></li>
							<li><a href="directory.html">Listing</a></li>
							<li><a href="events.html">Events</a></li>
							<li><a href="contacts.html">Contacts</a></li>
						</ul>
					</div>
				</div>							

				<div class="col-lg-3 col-md-6 col-sm-6">
					<a data-toggle="collapse" data-target="#collapse_ft_3" aria-expanded="false" aria-controls="collapse_ft_3" class="collapse_bt_mobile">
						<h3>Contacts</h3>
						<div class="circle-plus closed">
							<div class="horizontal"></div>
							<div class="vertical"></div>
						</div>
					</a>
					<div class="collapse show" id="collapse_ft_3">
						<ul class="contacts">
						<li><i class="ti-home"></i>Durban<br>South Africa</li>							
						<li><i class="ti-headphone-alt"></i></li>
							<li><i class="ti-email"></i><a href="#0">info@discoverbusiness.co.za</a></li>
						</ul>
					</div>
				</div>
			</div>
			<!-- /row-->
			<hr>
		</div>
	</footer>
	<!--/footer-->
	</div>
	<!-- page -->
	
	<!-- Sign In Popup -->
	<div id="sign-in-dialog" class="zoom-anim-dialog mfp-hide">
		<div class="small-dialog-header">
			<h3>Sign In</h3>
		</div>
		<form>
			<div class="sign-in-wrapper">
				<a href="#0" class="social_bt facebook">Login with Facebook</a>
				<a href="#0" class="social_bt google">Login with Google</a>
				<div class="divider"><span>Or</span></div>
				<div class="form-group">
					<label>Email</label>
					<input type="email" class="form-control" name="email" id="email">
					<i class="icon_mail_alt"></i>
				</div>
				<div class="form-group">
					<label>Password</label>
					<input type="password" class="form-control" name="password" id="password" value="">
					<i class="icon_lock_alt"></i>
				</div>
				<div class="clearfix add_bottom_15">
					<div class="checkboxes float-left">
						<label class="container_check">Remember me
						  <input type="checkbox">
						  <span class="checkmark"></span>
						</label>
					</div>
					<div class="float-right mt-1"><a id="forgot" href="javascript:void(0);">Forgot Password?</a></div>
				</div>
				<div class="text-center"><input type="submit" value="Log In" class="btn_1 full-width"></div>
				<div class="text-center">
					Don’t have an account? <a href="register.html">Sign up</a>
				</div>
				<div id="forgot_pw">
					<div class="form-group">
						<label>Please confirm login email below</label>
						<input type="email" class="form-control" name="email_forgot" id="email_forgot">
						<i class="icon_mail_alt"></i>
					</div>
					<p>You will receive an email containing a link allowing you to reset your password to a new preferred one.</p>
					<div class="text-center"><input type="submit" value="Reset Password" class="btn_1"></div>
				</div>
			</div>
		</form>
		<!--form -->
	</div>
	<!-- /Sign In Popup -->
	
	<div id="toTop"></div><!-- Back to top button -->
	
	<!-- COMMON SCRIPTS -->
    <script src="js/common_scripts.js"></script>
	<script src="js/functions.js"></script>
	<script src="assets/validate.js"></script>

	<script>
		const API_URL = 'https://discover-business-backend.vercel.app//api/events';
	  
		async function fetchEvents() {
		  try {
			const response = await fetch(API_URL);
			if (!response.ok) throw new Error('Failed to fetch events');
	  
			const events = await response.json();
			populateEventList(events);
		  } catch (error) {
			console.error(error);
			showError('Could not load events.');
		  }
		}
		function convertFirestoreTimestampParts(timestamp) {
			if (!timestamp || typeof timestamp._seconds !== 'number') {
				return { month: 'N/A', day: '??', weekday: '---' };
			}

			const milliseconds = timestamp._seconds * 1000 + Math.floor(timestamp._nanoseconds / 1e6);
			const date = new Date(milliseconds);

			const month = date.toLocaleDateString('en-US', { month: 'short' }); // e.g., "Dec"
			const day = date.getDate(); // e.g., 23
			const weekday = date.toLocaleDateString('en-US', { weekday: 'short' }); // e.g., "Sat"

			return { month, day, weekday };
			}

		function populateEventList(events) {
			console.log(events)
		  const container = document.getElementById('event-list-container');

		  if (!container) return;
	  
		  container.innerHTML = '';
	  
		  if (events.length === 0) {
			container.innerHTML = '<p>No events found.</p>';
			return;
		  }
	  
		  events.forEach(event => {
			const { month, day, weekday } = convertFirestoreTimestampParts(event.date); // ✅ FIXED LINE

			const card = document.createElement('div');
			// card.className = 'strip_booking';
			card.innerHTML = `
			
			<div class="row">
						<div class="col-lg-2 col-md-2">
							<div class="date">
								<span class="month">${month}</span>
                                <span class="day"><strong>${day}</strong>${weekday}</span>
							</div>
						</div>
						<div class="col-lg-6 col-md-5">
							<h3 class="hotel_booking">${event.title}<span>${event.description}</span></h3>
						</div>
						<div class="col-lg-2 col-md-3">
							<ul class="info_booking">
								<li><strong>Location</strong> ${event.location}</li>
								<li><strong>Price</strong> ${event.price}</li>

							</ul>
						</div>
						<div class="col-lg-2 col-md-2">
							<div class="booking_buttons">
								<a  href="${event.link}" target="_blank" class="btn_2">More info</a>
							</div>
						</div>
					</div> 
					<hr> `;
	  
			container.appendChild(card);
		  });
		}
		
		function showError(message) {
		  const container = document.getElementById('event-list-container');
		  if (container) {
			container.innerHTML = `<p class="error">${message}</p>`;
		  }
		}
	  
		window.addEventListener('DOMContentLoaded', fetchEvents);
	  </script>
	  
  
</body>

</html>